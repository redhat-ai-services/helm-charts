# gitops-tenant

A Helm chart to manage a multi-tiered gitops structure a project.

![Version: 0.3.12](https://img.shields.io/badge/Version-0.3.12-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square)

## Resources Created

This helm chart deploys the following namespaces:

| Namespace | Description | Default Permissions |
| ----------- | ----------- | ----------- |
| my-tenant-gitops | This namespace will contain an ArgoCD instance that manages deploying resources to all of the other namespaces. | Admin |
| my-tenant-pipelines   | This namespace will host Tekton / OpenShift Pipeline resources. | Admin |
| my-tenant-dev   | This namespace is the development namespace used for application components. | Admin |
| my-tenant-test   | This namespace is the test namespace used for application components. | View |
| my-tenant-prod   | This namespace is the production namespace used for application components. | View |

This helm chart will create the following group to grant permissions to the various namespaces:

| Group |
| ----- |
| my-tenant-admins |

## Installing the Chart

To access charts from this from the cli repository add it:

```sh
helm repo add redhat-ai-services https://redhat-ai-services.github.io/helm-charts/
helm repo update redhat-ai-services
helm upgrade -i [release-name] redhat-ai-services/gitops-tenant
```

To include a chart from this repository in an umbrella chart, include it in your dependencies in your `Chart.yaml` file.

```yaml
apiVersion: v2
name: example-chart
description: A Helm chart for Kubernetes
type: application

version: 0.1.0

appVersion: "1.16.0"

dependencies:
  - name: "gitops-tenant"
    version: "0.3.12"
    repository: "https://redhat-ai-services.github.io/helm-charts/"
```

## Requirements

Kubernetes: `>= 1.19.0`

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| additionalRoles | list | `[{"name":"sealed-secrets-deployer","rules":[{"apiGroups":["bitnami.com"],"resources":["sealedsecrets"],"verbs":["get","list","watch","create","update","patch","delete"]}],"subject":{"name":"argocd-argocd-application-controller"}}]` | Additional roles to apply to the application controller service account in all namespaces managed by ArgoCD |
| adminGroup.create | bool | `true` | Enable the creation of the admin group.  If creation is disabled, an existing group can still be specified with the nameOverride. |
| adminGroup.members | list | `[]` | List of users to be added to the adminGroup |
| adminGroup.nameOverride | string | `""` | String to override the name of the admin group |
| fullnameOverride | string | `""` | String to fully override fullname template |
| nameOverride | string | `""` | String to partially override fullname template (will maintain the release name) |
| namespaces[0] | object | `{"adminGroupRole":"admin","annotations":{},"labels":{},"nameOverride":"","nameSuffix":"gitops","role":"gitops"}` | GitOps namespace configuration for managing objects in all tenant namespaces |
| namespaces[1] | object | `{"adminGroupRole":"admin","annotations":{"operator.tekton.dev/prune.keep-since":"7200","operator.tekton.dev/prune.resources":"taskrun, pipelinerun"},"labels":{},"nameOverride":"","nameSuffix":"pipelines","role":"pipelines"}` | Pipelines namespace for executing pipelines |
| namespaces[2] | object | `{"adminGroupRole":"admin","annotations":{},"createOperatorGroup":true,"labels":{},"nameOverride":"","nameSuffix":"dev","role":"dev"}` | Dev application namespace |
| namespaces[3] | object | `{"adminGroupRole":"view","annotations":{},"createOperatorGroup":true,"labels":{},"nameOverride":"","nameSuffix":"test","role":"test"}` | Test application namespace |
| namespaces[4] | object | `{"adminGroupRole":"view","annotations":{},"createOperatorGroup":true,"labels":{},"nameOverride":"","nameSuffix":"prod","role":"prod"}` | Prod application namespace |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
